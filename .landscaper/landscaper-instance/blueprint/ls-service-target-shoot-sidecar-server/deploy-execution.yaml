deployItems:
  - name: ls-service-target-shoot-sidecar-server
    type: landscaper.gardener.cloud/helm
    target:
      import: hostingCluster
    config:
      apiVersion: helm.deployer.landscaper.gardener.cloud/v1alpha1
      kind: ProviderConfiguration
      updateStrategy: patch
      name: ls-service-target-shoot-sidecar-server
      namespace: {{ .imports.hostingClusterNamespace }}
      createNamespace: true

      chart:
        {{ $resource := getResource .cd "name" "ls-service-target-shoot-sidecar-chart" }} 
        ref: {{ $resource.access.imageReference }}

      values:
        lsServiceTargetShootSidecar:
          verbosity: {{ .imports.landscaperConfig.landscaper.verbosity | default "info" }} #TODO import

        controller:
          kubeconfig: |
{{ .imports.landscaperControllerKubeconfigYaml | indent 12 }} #TODO import

          {{ $landscaperComponent := getComponent .cd "name" "landscaper" }}


          {{ $imgresource := getResource .cd "name" "landscaper-service-target-shoot-sidecar-server" }}
          {{ $imgrepo := ociRefRepo $imgresource.access.imageReference }}
          {{ $imgtag := ociRefVersion $imgresource.access.imageReference }}
          image:
            repository: {{ $imgrepo }}
            tag: {{ $imgtag }}
            pullPolicy: IfNotPresent

        service:
          type: ClusterIP
          port: 80

        resources:
{{ toYaml .imports.landscaperConfig.landscaper.resources | indent 10 }} # TODO: import
